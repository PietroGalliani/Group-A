Modular Branch -- new, commented version
